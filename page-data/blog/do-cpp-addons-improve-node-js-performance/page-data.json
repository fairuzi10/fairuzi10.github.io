{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/do-cpp-addons-improve-node-js-performance/","result":{"data":{"post":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Do you know that you could code C++ and use it in your Node Application? What are the benefits? Does it make you application faster? Is it worth it to do? "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"No, it isnâ€™t."}]},{"type":"text","value":" Donâ€™t get me wrong, let me explain ðŸ˜„."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"C++ Addons"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Node.js Addons are dynamically-linked shared objects, written in C++, that can be loaded into Node.js using the require() function, and used just as if they were an ordinary Node.js module."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So basically, you could code C++ with Node addons framework (I prefer "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/nodejs/nan","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"nan"}]},{"type":"text","value":" for compability reasons) like the following"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"cpp"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-cpp"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-cpp"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","macro","property"]},"children":[{"type":"text","value":"#"},{"type":"element","tagName":"span","properties":{"className":["token","directive","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"<nan.h>"}]}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Method"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" Nan"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"FunctionCallbackInfo"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"v8"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"Value"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"&"}]},{"type":"text","value":" info"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  info"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"GetReturnValue"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Set"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"Nan"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"New"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"world\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"ToLocalChecked"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"void"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Init"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"v8"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"Local"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"v8"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"Object"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" exports"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  exports"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"->"}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"Set"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"Nan"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"New"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"hello\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"ToLocalChecked"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n               Nan"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"New"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"v8"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"::"}]},{"type":"text","value":"FunctionTemplate"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"Method"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"->"}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"GetFunction"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"NODE_MODULE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"hello"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" Init"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And use it in your Node application"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"js"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"var"}]},{"type":"text","value":" addon "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"require"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"bindings\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"hello\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\nconsole"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"addon"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"hello"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"// 'world'"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So why bother leaving the beautiful, interpreted, high-level world of Javascript and go into the dark, compiled, and low-level world of C++? I thought it must be for performance. Come on, who doesnâ€™t know that C++ is one of the fastest language around? So I decided to give it a shot in hope that I would make super-fast code and can publish it in NPM like our fellow cool JS boys do every seconds. So what is the result? Letâ€™s jump right into the benchmark. Anyway, all codes are available "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/fairuzi10/node-addons-benchmark","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"in my Github"}]},{"type":"text","value":" and the data is in "},{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/spreadsheets/d/15oy6BME_C3uDi9Y_-8E_NRg-Sm36LTynSsseFsULGP0/edit?usp=sharing","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"Google Spreadsheets"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Matrix Exponentiation"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For the first experiment, instead of the boring prime-generator-or-so problem, letâ€™s just try matrix exponentiation. For the sake of simplicity, letâ€™s use naive matrix multiplication in "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(N^3)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.064108em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8141079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"3"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" but with "},{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Modular_exponentiation","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"modular exponentiation"}]},{"type":"text","value":" result in "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"l"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"o"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(N^3logP)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.064108em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8141079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"3"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.01968em;"},"children":[{"type":"text","value":"l"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"o"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"g"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" algorithm. Before we go to the exponentation, letâ€™s do some benchmarking for just multiplication."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/fff80/multiplication.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.963190184049076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQoz5WS247DIAxE+f9PbcLN5urYZkVI05W2rbTzMMLIwyEOhoiccyEE73065U4BgLV2rbdtc85Za4lo/JJRVWZehep00ZEqI0LJmXOqtaaUng2XVqth5lKKqorI7d/LMbR0aTTMfYdz9/JPpcj0SiNkmWQiQkQRYebb35YnmFOVWOZihv9FhiK5v/aNiLTW1vHzqy7SZC3UGDqGdOKQpbQJ1Of957TXD7hQ44kaa/LaeKQ+YhaR2SOtSatHQiUyK8atc6naW8UcPYJHt4PdcX/E6DBH7N6Rd9XajkAIPWdVNecMhXIpMWrvYXPBRrd7/9g5p7g9CKHGgAAsAgB0HK33dIe/6DiOe2Z/9Sb8ekPnsxifwz/6wsIPgheV+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"C++ vs. Node JS on Matrix Multiplication","title":"C++ vs. Node JS on Matrix Multiplication","src":"/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/fff80/multiplication.png","srcSet":["/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/c649e/multiplication.png 163w","/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/3a76f/multiplication.png 325w","/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/fff80/multiplication.png 600w"],"sizes":["(max-width:","600px)","100vw,","600px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As we could see, C++ addon beats plain Javascript implementation by around 380%. Now itâ€™s time for exponentiation, letâ€™s put "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"100"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"N = 100"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"text","value":" to make things simple (who likes multi-variable function?)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/9d856122750dbfbbfea6e26feb6f1b4c/fff80/exponentiation.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.963190184049076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDElEQVQoz5WS0W7EIAwE+f9vPSAEMGC8dkXSa3N3UaXO02jjJUqwY2bv/bZtMcZyEGMMIaSUvPchhBjj4/EIIXjvSyl2weHAzNRMdUUCK01yzlSr1EJE144+WeV5cObHI3yIAjgLP3Li5MBM+1QaSh2drfGSNrR23StSxU66k15EB8MB0ock0rqmQV3Ocu1CHTwVuH8zAAeZYR88YQZVKMQU9iKAyPcZT1GRVTZF7YD+/o83+SN0zDx6197QCI2E6pvchksmOzPjnEdKo5SRc8/7yPkqt2Hf9znGKq+7Egg0l7ptaQI8xYdIrUGtVAoxTsEUhBhLJYGyCFTddWPWlrx+lZwroHo78Fr+J1+QSMEwNp8NBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"C++ vs. Node JS on Matrix Exponentiation","title":"C++ vs. Node JS on Matrix Exponentiation","src":"/static/9d856122750dbfbbfea6e26feb6f1b4c/fff80/exponentiation.png","srcSet":["/static/9d856122750dbfbbfea6e26feb6f1b4c/c649e/exponentiation.png 163w","/static/9d856122750dbfbbfea6e26feb6f1b4c/3a76f/exponentiation.png 325w","/static/9d856122750dbfbbfea6e26feb6f1b4c/fff80/exponentiation.png 600w"],"sizes":["(max-width:","600px)","100vw,","600px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We got a nice logarithmic graph here. Itâ€™s 430% improvement, better than the previous one. Remember that you could go to "},{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/spreadsheets/d/15oy6BME_C3uDi9Y_-8E_NRg-Sm36LTynSsseFsULGP0/edit?usp=sharing#gid=109010642","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"the spreadsheet"}]},{"type":"text","value":" to go through the details."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"String Matching"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Letâ€™s see another problem we could code using C++ Addons. To make things more interesting, letâ€™s play with something we havenâ€™t tried before, string. Given two string, count the number of occurrence of the second string in the first one. One could solve this problem in "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(NM)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" but there are faster algorithms too, one of which is "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(N + M)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" rolling hash algorithm. Letâ€™s use this one."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To test it, I decided to put "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mfrac","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"10"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"M = \\frac{N}{10}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.217331em;vertical-align:-0.345em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mopen","nulldelimiter"]},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mfrac"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.872331em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.6550000000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.23em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["frac-line"],"style":"border-bottom-width:0.04em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.394em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"â€‹"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.345em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose","nulldelimiter"]},"children":[]}]}]}]}]},{"type":"text","value":" and because the complexity is "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(N + M)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"M"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":", it should not affecting the improvement percentage too much for whatever value I put into M. This is what I got."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/3983aa4973c96bb5413aa90caf3c82cf/fff80/matching.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.963190184049076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKklEQVQoz5VS2W4DIQzc///QSMkC5jCXsU0Fm0pJVVXpPFg+NHgY+SAi55z3HgBwAwCccyEE77219jxPt6Gq8x2HiDDzVVxD0YmVMaWSM2estSLimr5jkccYvffFEbm6V/JrecX9jiwyMxPRJ+Q5dcvU2jVkpvEBeS1RpSGlS8gcy0poyE/ZIiqizHuJLjKxYOWQ2eOoXYhYRbYCeTVMd/f5H5aZm8SiWLV0EZ2XQ8+4TN2G9d5ra9eAZBaavgg2Le1buLC0OjJKLVzyiojkQYmOOSfRCC6djwAmJkgVgMB1sM3ZZm21tqfYUiRMLcWeItVCRKq6yL1RdMncbv5+j+fDPu6YszEmpQQbq7QWS7EAMS0YY8YYx/wTY4xndp2X6ny5s+N7pPP/+AKGsMAuxzUeqgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"C++ vs. Node JS on String Matching","title":"C++ vs. Node JS on String Matching","src":"/static/3983aa4973c96bb5413aa90caf3c82cf/fff80/matching.png","srcSet":["/static/3983aa4973c96bb5413aa90caf3c82cf/c649e/matching.png 163w","/static/3983aa4973c96bb5413aa90caf3c82cf/3a76f/matching.png 325w","/static/3983aa4973c96bb5413aa90caf3c82cf/fff80/matching.png 600w"],"sizes":["(max-width:","600px)","100vw,","600px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We got 350% improvement here. Not differed too much compared to our previous benchmark. But if you look closely to "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/fairuzi10/node-addons-benchmark/blob/master/matching/matching.js#L50","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"the code"}]},{"type":"text","value":", you should notice that my Javascript implementation is not exactly the same as my C++ addon implementation. It turns out that Javascript is quite slow at building string, so I need to made a few modifications to speed up the process. Donâ€™t worry, I only count the time needed to run "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"countOccurrence"}]},{"type":"text","value":" so it wouldnâ€™t affect the result."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Facing that string problem, I think itâ€™s a good idea to try buffer which is well-known for its speed. Not only for C++ addon, I try it for the pure Javascript too. Here is the result."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/7097dbab6139d8adad9ea6f99e272bd2/fff80/matching-buffer.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.963190184049076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVQoz42QbW/dIAyF8/9/4dRK1XqzXvICCQFMwPilStikfpjWPUiWsXXkYw+IuG2b937f93SzbZtz7jgO7721dl3XXvHeO+estYioNwMzM5GqQpUYIwAQwJkhJmAM5YQQImSIeOacY4w5ZxGVm6G1VmtVVWbupZ789dujXlq+JhNRt/GtWFVul3JWOYCwyfdikSvBRrnyARQy58JIck3+aptZmIWY+gwRRuJU6MjigU9URBJmFSIMIjjcTqhb6vswc2OFIiFLOjlXZq5CSeUU3KVtgl5aVKGh1lpK6acn1tI0QMsZzpy4HlKdVMtpbXGlZBtEPs8ag3cL1jKoasU6W/M+/vwYX6fnizMvfn7bzeti3qZpNOYxu2l287ItkzWzNfZwHgJSu8SllsU+H+8/zMdjNuP4/LUcfpwnH8J+kwCscwnA7XuIMca0WUdEg/6T1trv7DrHHa/Xgw5/Wl/Qu/MffAIPNrqwJffU9QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"C++ vs. Node JS on String Matching with Buffer","title":"C++ vs. Node JS on String Matching with Buffer","src":"/static/7097dbab6139d8adad9ea6f99e272bd2/fff80/matching-buffer.png","srcSet":["/static/7097dbab6139d8adad9ea6f99e272bd2/c649e/matching-buffer.png 163w","/static/7097dbab6139d8adad9ea6f99e272bd2/3a76f/matching-buffer.png 325w","/static/7097dbab6139d8adad9ea6f99e272bd2/fff80/matching-buffer.png 600w"],"sizes":["(max-width:","600px)","100vw,","600px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comparing C++ addon + buffer with Javascript + buffer, we got 300% improvement which is less than the previous one which might confirm my suspicion about slow Javascriptâ€™s string performance. If we compare C++ addon + buffer with Javascript without buffer, we got 550% improvement in total."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Set"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OK, we already have 2 classic problems, but what about builtin data structure? Letâ€™s give "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Set"}]},{"type":"text","value":" a try. In Javascript, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Set"}]},{"type":"text","value":" actually "},{"type":"element","tagName":"a","properties":{"href":"https://codereview.chromium.org/220293002/#ps1","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"implements hash table"}]},{"type":"text","value":" so weâ€™ll compare it with "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/fairuzi10/node-addons-benchmark/blob/master/set/schema.cc#L13","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"C++ unordered_set"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/e80491e4c000f02e51d4798ee207d922/fff80/set.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 61.963190184049076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQoz5WS2W7EIAxF+f8PnVYjQgCb1VsVosxStap6HsC+yHgBN+cMIeyLnDMihkXO2Xt/6jHGhyIiduFkYU9U1LAxQK6lSC21NUR8Hl8cwXPO3ruZicipnsY3ly/RTI8EK597vfLV+NFV1Ulah0aUyebGGKUUVSWiswVmfqwr2WHUzthkB8IujYxF/8482XBo7oZdiZdIZL1KLcbsiGiMYarCvAJWa2ZlSCoCjWsuXCsjSE5jD4TAtRKiMjtmJqJrjNZJE/QUK0acKQkkqUVbkzHeqjuf6pgzUU2w3aO/bfunx7BTgVmQFnMNY572PPejWFU9gmnMEvP99pFSAshhD1iq3wIAHF8kBATw3iPitm05Z1guETl7ZzX9dM+OfsM9Zm1q/+ULwpvATFCslcQAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"C++ vs. Node JS on Set (Hash Table)","title":"C++ vs. Node JS on Set (Hash Table)","src":"/static/e80491e4c000f02e51d4798ee207d922/fff80/set.png","srcSet":["/static/e80491e4c000f02e51d4798ee207d922/c649e/set.png 163w","/static/e80491e4c000f02e51d4798ee207d922/3a76f/set.png 325w","/static/e80491e4c000f02e51d4798ee207d922/fff80/set.png 600w"],"sizes":["(max-width:","600px)","100vw,","600px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We got 160% improvement here, the smallest of all our benchmark. If you look carefully in "},{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/spreadsheets/d/15oy6BME_C3uDi9Y_-8E_NRg-Sm36LTynSsseFsULGP0/edit?usp=sharing#gid=238918653","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"the spreadsheet"}]},{"type":"text","value":" you might notice that in "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1.000.000"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"N = 1.000.000"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"text","value":", Javascriptâ€™s Set performance even become the winner, the only case we see pure Javascript win over C++ addon in quite high N. So if you want to use some data structures, youâ€™re good to go with native ES6 data structures."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Summary"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From all the benchmark we have, we could expect C++ addons improve our Node JS app performance around 300% up to 500%. Is it good enough? I donâ€™t think so. With only for a few performance improvements, you need to code in C++, connect it to your Node app, and donâ€™t forget to maintain it. With all these burden, you are better off investing your time optimizing the algorithm you use if performance really matters to you. During this experiment, I also came accross "},{"type":"element","tagName":"a","properties":{"href":"https://nodeaddons.com/streaming-data-from-c-to-node-js/#example---sensor-data","target":"_blank","rel":["nofollow","noopener","noreferrer"]},"children":[{"type":"text","value":"a reference"}]},{"type":"text","value":" that supports my opinion."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Believe it or not, performance isnâ€™t the most common reason we create C++ addons for Node.js.\nPerhaps the most common reason addons are used is their ability to leverage existing C++ code.\nThis can be especially critical when interacting with devices - specifically devices that only provide C/C++ APIâ€™s."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{"className":["section-divider"]},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Before I try the addons, I hope for at least "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"10"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"Ã—"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"10\\times"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.72777em;vertical-align:-0.08333em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"Ã—"}]}]}]}]},{"type":"text","value":" improvement because JS is an interpreted, dynamic-typed language which I thought must be slow. Yes, I look at you, Python. It turns out that Node JS is already fast and even comparable to C++ so we donâ€™t have to struggle code in the hard way just to make sure our code run fast. After all, this experiment was a fun. Itâ€™s interesting to see how fast Node JS is thanks to the great work V8 engine has done. ðŸ˜„"}]}],"data":{"quirksMode":false}},"timeToRead":6,"frontmatter":{"title":"Do C++ Addons Improve Node JS Performance? A Benchmark","date":"13 January 2019","description":"Do you know that you could code C++ and use it in your Node Application? What are the benefits? Does it make you application faster? Is it worth it to do? Let the benchmark speaks.","tags":["Knowledge","Coding"],"thumbnail":{"publicURL":"/static/08f6f43d3e266dd0f09ca78e7e7bf9cc/multiplication.png"},"lang":null},"fields":{"slug":"/blog/do-cpp-addons-improve-node-js-performance/"}},"relatedPost":{"edges":[{"node":{"id":"12750ce5-d6a3-5a3b-8f61-f7c2817cb49c","fields":{"slug":"/blog/inheritance-tanpa-oop/"},"frontmatter":{"title":"Inheritance Tanpa OOP","description":"Masih berpikir bahwa inheritance hanya dapat dilakukan dengan OOP? Baca pos ini dan ubah pemikiran tersebut."}}},{"node":{"id":"5b01096c-bcbf-50cd-be72-52036a074412","fields":{"slug":"/blog/upscale-gojek/"},"frontmatter":{"title":"Gojek Upscale 3.0: Ready to Upscale Yourself?","description":"Want to learn best practices of software engineering from experts in the industry? Gojek Upscale is for you. Find out what will you get by joining this great event."}}}]}},"pageContext":{"slug":"/blog/do-cpp-addons-improve-node-js-performance/","tags":["Knowledge","Coding"]}},"staticQueryHashes":[]}